<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Linear Regression"><meta name="keywords" content="rust, rustlang, rust-lang, linear_regression"><title>smartcore::linear::linear_regression - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../main.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../smartcore/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../../smartcore/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Module linear_regression</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../../smartcore/index.html"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Module <a href="../../index.html">smartcore</a>::<wbr><a href="../index.html">linear</a>::<wbr><a class="mod" href="#">linear_regression</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../../src/smartcore/linear/linear_regression.rs.html#1-289">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="linear-regression"><a href="#linear-regression">Linear Regression</a></h2>
<p>Linear regression is a very straightforward approach for predicting a quantitative response \(y\) on the basis of a linear combination of explanatory variables \(X\).
Linear regression assumes that there is approximately a linear relationship between \(X\) and \(y\). Formally, we can write this linear relationship as</p>
<p>\[y \approx \beta_0 + \sum_{i=1}^n \beta_iX_i + \epsilon\]</p>
<p>where \(\epsilon\) is a mean-zero random error term and the regression coefficients \(\beta_0, \beta_0, … \beta_n\) are unknown, and must be estimated.</p>
<p>While regression coefficients can be estimated directly by solving</p>
<p>\[\hat{\beta} = (X^TX)^{-1}X^Ty \]</p>
<p>the \((X^TX)^{-1}\) term is both computationally expensive and numerically unstable. An alternative approach is to use a matrix decomposition to avoid this operation.
SmartCore uses <a href="../../linalg/svd/index.html">SVD</a> and <a href="../../linalg/qr/index.html">QR</a> matrix decomposition to find estimates of \(\hat{\beta}\).
The QR decomposition is more computationally efficient and more numerically stable than calculating the normal equation directly,
but does not work for all data matrices. Unlike the QR decomposition, all matrices have an SVD decomposition.</p>
<p>Example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">smartcore::linalg::naive::dense_matrix</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">smartcore::linear::linear_regression</span>::<span class="kw-2">*</span>;

<span class="comment">// Longley dataset (https://www.statsmodels.org/stable/datasets/generated/longley.html)</span>
<span class="kw">let</span> <span class="ident">x</span> <span class="op">=</span> <span class="ident">DenseMatrix::from_2d_array</span>(<span class="kw-2">&amp;</span>[
              <span class="kw-2">&amp;</span>[<span class="number">234.289</span>, <span class="number">235.6</span>, <span class="number">159.0</span>, <span class="number">107.608</span>, <span class="number">1947.</span>, <span class="number">60.323</span>],
              <span class="kw-2">&amp;</span>[<span class="number">259.426</span>, <span class="number">232.5</span>, <span class="number">145.6</span>, <span class="number">108.632</span>, <span class="number">1948.</span>, <span class="number">61.122</span>],
              <span class="kw-2">&amp;</span>[<span class="number">258.054</span>, <span class="number">368.2</span>, <span class="number">161.6</span>, <span class="number">109.773</span>, <span class="number">1949.</span>, <span class="number">60.171</span>],
              <span class="kw-2">&amp;</span>[<span class="number">284.599</span>, <span class="number">335.1</span>, <span class="number">165.0</span>, <span class="number">110.929</span>, <span class="number">1950.</span>, <span class="number">61.187</span>],
              <span class="kw-2">&amp;</span>[<span class="number">328.975</span>, <span class="number">209.9</span>, <span class="number">309.9</span>, <span class="number">112.075</span>, <span class="number">1951.</span>, <span class="number">63.221</span>],
              <span class="kw-2">&amp;</span>[<span class="number">346.999</span>, <span class="number">193.2</span>, <span class="number">359.4</span>, <span class="number">113.270</span>, <span class="number">1952.</span>, <span class="number">63.639</span>],
              <span class="kw-2">&amp;</span>[<span class="number">365.385</span>, <span class="number">187.0</span>, <span class="number">354.7</span>, <span class="number">115.094</span>, <span class="number">1953.</span>, <span class="number">64.989</span>],
              <span class="kw-2">&amp;</span>[<span class="number">363.112</span>, <span class="number">357.8</span>, <span class="number">335.0</span>, <span class="number">116.219</span>, <span class="number">1954.</span>, <span class="number">63.761</span>],
              <span class="kw-2">&amp;</span>[<span class="number">397.469</span>, <span class="number">290.4</span>, <span class="number">304.8</span>, <span class="number">117.388</span>, <span class="number">1955.</span>, <span class="number">66.019</span>],
              <span class="kw-2">&amp;</span>[<span class="number">419.180</span>, <span class="number">282.2</span>, <span class="number">285.7</span>, <span class="number">118.734</span>, <span class="number">1956.</span>, <span class="number">67.857</span>],
              <span class="kw-2">&amp;</span>[<span class="number">442.769</span>, <span class="number">293.6</span>, <span class="number">279.8</span>, <span class="number">120.445</span>, <span class="number">1957.</span>, <span class="number">68.169</span>],
              <span class="kw-2">&amp;</span>[<span class="number">444.546</span>, <span class="number">468.1</span>, <span class="number">263.7</span>, <span class="number">121.950</span>, <span class="number">1958.</span>, <span class="number">66.513</span>],
              <span class="kw-2">&amp;</span>[<span class="number">482.704</span>, <span class="number">381.3</span>, <span class="number">255.2</span>, <span class="number">123.366</span>, <span class="number">1959.</span>, <span class="number">68.655</span>],
              <span class="kw-2">&amp;</span>[<span class="number">502.601</span>, <span class="number">393.1</span>, <span class="number">251.4</span>, <span class="number">125.368</span>, <span class="number">1960.</span>, <span class="number">69.564</span>],
              <span class="kw-2">&amp;</span>[<span class="number">518.173</span>, <span class="number">480.6</span>, <span class="number">257.2</span>, <span class="number">127.852</span>, <span class="number">1961.</span>, <span class="number">69.331</span>],
              <span class="kw-2">&amp;</span>[<span class="number">554.894</span>, <span class="number">400.7</span>, <span class="number">282.7</span>, <span class="number">130.081</span>, <span class="number">1962.</span>, <span class="number">70.551</span>],
         ]);

<span class="kw">let</span> <span class="ident">y</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">f64</span><span class="op">&gt;</span> <span class="op">=</span> <span class="macro">vec!</span>[<span class="number">83.0</span>, <span class="number">88.5</span>, <span class="number">88.2</span>, <span class="number">89.5</span>, <span class="number">96.2</span>, <span class="number">98.1</span>, <span class="number">99.0</span>,
          <span class="number">100.0</span>, <span class="number">101.2</span>, <span class="number">104.6</span>, <span class="number">108.4</span>, <span class="number">110.8</span>, <span class="number">112.6</span>, <span class="number">114.2</span>, <span class="number">115.7</span>, <span class="number">116.9</span>];

<span class="kw">let</span> <span class="ident">lr</span> <span class="op">=</span> <span class="ident">LinearRegression::fit</span>(<span class="kw-2">&amp;</span><span class="ident">x</span>, <span class="kw-2">&amp;</span><span class="ident">y</span>,
            <span class="ident">LinearRegressionParameters::default</span>().
            <span class="ident">with_solver</span>(<span class="ident">LinearRegressionSolverName::QR</span>)).<span class="ident">unwrap</span>();

<span class="kw">let</span> <span class="ident">y_hat</span> <span class="op">=</span> <span class="ident">lr</span>.<span class="ident">predict</span>(<span class="kw-2">&amp;</span><span class="ident">x</span>).<span class="ident">unwrap</span>();</code></pre></div>
<h3 id="references"><a href="#references">References:</a></h3>
<ul>
<li><a href="https://www.microsoft.com/en-us/research/uploads/prod/2006/01/Bishop-Pattern-Recognition-and-Machine-Learning-2006.pdf">“Pattern Recognition and Machine Learning”, C.M. Bishop, Linear Models for Regression</a></li>
<li><a href="http://faculty.marshall.usc.edu/gareth-james/ISL/">“An Introduction to Statistical Learning”, James G., Witten D., Hastie T., Tibshirani R., 3. Linear Regression</a></li>
<li><a href="http://numerical.recipes/">“Numerical Recipes: The Art of Scientific Computing”,  Press W.H., Teukolsky S.A., Vetterling W.T, Flannery B.P, 3rd ed., Section 15.4 General Linear Least Squares</a></li>
</ul>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.LinearRegression.html" title="smartcore::linear::linear_regression::LinearRegression struct">LinearRegression</a></div><div class="item-right docblock-short"><p>Linear Regression</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.LinearRegressionParameters.html" title="smartcore::linear::linear_regression::LinearRegressionParameters struct">LinearRegressionParameters</a></div><div class="item-right docblock-short"><p>Linear Regression parameters</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.LinearRegressionSolverName.html" title="smartcore::linear::linear_regression::LinearRegressionSolverName enum">LinearRegressionSolverName</a></div><div class="item-right docblock-short"><p>Approach to use for estimation of regression coefficients. QR is more efficient but SVD is more stable.</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="smartcore" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0-nightly (10f4ce324 2022-06-22)" ></div>
</body></html>