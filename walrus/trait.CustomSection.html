<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A trait for implementing custom sections."><meta name="keywords" content="rust, rustlang, rust-lang, CustomSection"><title>CustomSection in walrus - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../walrus/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../walrus/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">CustomSection</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><ul><li><a href="#tymethod.data">data</a></li><li><a href="#tymethod.name">name</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#provided-methods">Provided Methods</a></h3><ul><li><a href="#method.add_gc_roots">add_gc_roots</a></li><li><a href="#method.apply_code_transform">apply_code_transform</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementations">Methods</a></h3><ul><li><a href="#method.as_any">as_any</a></li><li><a href="#method.as_any_mut">as_any_mut</a></li><li><a href="#method.into_any">into_any</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div></section><h2 class="location"><a href="index.html">In walrus</a></h2></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../walrus/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Trait <a href="index.html">walrus</a>::<wbr><a class="trait" href="#">CustomSection</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/walrus/module/custom.rs.html#18-62">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust trait"><code>pub trait CustomSection: WalrusAny + <a class="trait" href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> {
    fn <a href="#tymethod.name" class="fnname">name</a>(&amp;self) -&gt; &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.data" class="fnname">data</a>(&amp;self, ids_to_indices: &amp;<a class="struct" href="struct.IdsToIndices.html" title="struct walrus::IdsToIndices">IdsToIndices</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'_, [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>]&gt;;

    fn <a href="#method.add_gc_roots" class="fnname">add_gc_roots</a>(&amp;self, roots: &amp;mut <a class="struct" href="passes/struct.Roots.html" title="struct walrus::passes::Roots">Roots</a>) { ... }
<span class="item-spacer"></span>    fn <a href="#method.apply_code_transform" class="fnname">apply_code_transform</a>(&amp;mut self, transform: &amp;<a class="type" href="type.CodeTransform.html" title="type walrus::CodeTransform">CodeTransform</a>) { ... }
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A trait for implementing <a href="https://webassembly.github.io/spec/core/binary/modules.html#binary-customsec">custom
sections</a>.</p>
<p>Custom sections are added to a <code>walrus::Module</code> via
<code>my_module.custom_sections.add(my_custom_section)</code>.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.name" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#24">source</a></div><h4 class="code-header">fn <a href="#tymethod.name" class="fnname">name</a>(&amp;self) -&gt; &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a></h4></div></summary><div class="docblock"><p>Get this custom section’s name.</p>
<p>For example “.debug_info” for one of the DWARF custom sections or “name”
for the <a href="https://webassembly.github.io/spec/core/appendix/custom.html#name-section">names custom
section</a>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.data" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#31">source</a></div><h4 class="code-header">fn <a href="#tymethod.data" class="fnname">data</a>(&amp;self, ids_to_indices: &amp;<a class="struct" href="struct.IdsToIndices.html" title="struct walrus::IdsToIndices">IdsToIndices</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'_, [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>]&gt;</h4></div></summary><div class="docblock"><p>Get the data payload for this custom section.</p>
<p>This should <em>not</em> include the section header with id=0, the custom
section’s name, or the count of how many bytes are in the
payload. <code>walrus</code> will handle these for you.</p>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="method.add_gc_roots" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#39-41">source</a></div><h4 class="code-header">fn <a href="#method.add_gc_roots" class="fnname">add_gc_roots</a>(&amp;self, roots: &amp;mut <a class="struct" href="passes/struct.Roots.html" title="struct walrus::passes::Roots">Roots</a>)</h4></div></summary><div class="docblock"><p>Add any core wasm roots to the provided <code>roots</code> argument.</p>
<p>This function will add any referenced core wasm items into the <code>Roots</code>
array provided.</p>
<p>The default provided method does nothing.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.apply_code_transform" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#59-61">source</a></div><h4 class="code-header">fn <a href="#method.apply_code_transform" class="fnname">apply_code_transform</a>(&amp;mut self, transform: &amp;<a class="type" href="type.CodeTransform.html" title="type walrus::CodeTransform">CodeTransform</a>)</h4></div></summary><div class="docblock"><p>Apply the given code transformations to this custom section.</p>
<p>If the module was not configured with <code>preserve_code_transform = true</code>,
then this method is never called.</p>
<p>This method is called after we have emitted the non-custom Wasm
sections, just before a custom section’s data is emitted into the Wasm
binary. If this custom section references offsets in the Wasm code, this
is a chance to update them so they are valid for the new, transformed
Wasm code that is being emitted.</p>
<p>For example, DWARF debug info references Wasm instructions via offsets
into the code section, and we can use these transforms to fix those
offsets after having transformed various functions and instructions.</p>
<p>The default provided method does nothing.</p>
</div></details></div><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor"></a></h2><div id="implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><section id="impl" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#88-103">source</a></span><a href="#impl" class="anchor"></a><h3 class="code-header in-band">impl dyn <a class="trait" href="trait.CustomSection.html" title="trait walrus::CustomSection">CustomSection</a></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.into_any" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#90-92">source</a></span><a href="#method.into_any" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.into_any" class="fnname">into_any</a>(self: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;Self&gt;) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'static&gt;</h4></section></summary><div class="docblock"><p>Convert this custom section to <code>Box&lt;Any&gt;</code> to do dynamic downcasting</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.as_any" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#95-97">source</a></span><a href="#method.as_any" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.as_any" class="fnname">as_any</a>(&amp;self) -&gt; &amp;(dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>)</h4></section></summary><div class="docblock"><p>Convert this custom section to <code>&amp;Any</code> to do dynamic downcasting</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.as_any_mut" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#100-102">source</a></span><a href="#method.as_any_mut" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.as_any_mut" class="fnname">as_any_mut</a>(&amp;mut self) -&gt; &amp;mut (dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>)</h4></section></summary><div class="docblock"><p>Convert this custom section to <code>&amp;mut Any</code> to do dynamic downcasting</p>
</div></details></div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><section id="impl-CustomSection" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/walrus/module/custom.rs.html#115-123">source</a></span><a href="#impl-CustomSection" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="trait.CustomSection.html" title="trait walrus::CustomSection">CustomSection</a> for <a class="struct" href="struct.RawCustomSection.html" title="struct walrus::RawCustomSection">RawCustomSection</a></h3></section></div><script type="text/javascript" src="../implementors/walrus/module/custom/trait.CustomSection.js" data-ignore-extern-crates="" async></script></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="walrus" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0-nightly (10f4ce324 2022-06-22)" ></div>
</body></html>